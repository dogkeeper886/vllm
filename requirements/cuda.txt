# Common dependencies
-r common.txt

numba == 0.60.0; python_version == '3.9' # v0.61 doesn't support Python 3.9. Required for N-gram speculative decoding
numba == 0.61.2; python_version > '3.9'

# Dependencies for NVIDIA GPUs - Modified for Tesla K80 compatibility
ray[cgraph]>=2.48.0 # Ray Compiled Graph, required for pipeline parallelism in V1.
torch==1.12.1+cu113  # Tesla K80 compatible version (modified from 2.7.1)
# torchaudio==2.7.1  # Disabled for Tesla K80 compatibility
# These must be updated alongside torch
torchvision==0.13.1+cu113  # Tesla K80 compatible version (modified from 0.22.1)
# https://github.com/facebookresearch/xformers/releases/tag/v0.0.31
# xformers==0.0.31; platform_system == 'Linux' and platform_machine == 'x86_64'  # Disabled - requires PyTorch >= 2.7, not compatible with Tesla K80